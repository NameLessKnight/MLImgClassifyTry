## Languages

- [English](README.md)
- [中文](README.zh.md)
- [日本語](README.ja.md)

## Project Overview

This is a small image classification project based on PyTorch. It trains a ResNet-18 model to classify images and can batch-sort unorganized images.

Project purpose: iPhone photos and downloaded images get mixed together and are a pain to organize; machine learning has been hot lately, so I played around with it and had fun. The whole project was generated by AI — AI is truly amazing!!!

Main scripts:
- `train.py`: training script. It reads images from `dataset/train` and `dataset/val` (each subfolder is a class) and saves the best model as `best_classifier.pth` by default.
- `run.py`: inference / batch-sorting script. It copies images from `unsorted_images` into `sorted_images/<class>/` based on predicted labels (default classes: `anime`, `camera`, `other`).

## Directory structure

- `train.py`    # training entry
- `run.py`      # inference / batch classification
- `dataset/`    # must contain `train/` and `val/`, each subfolder is a class
- `unsorted_images/`  # images to classify
- `sorted_images/`    # output folder created by `run.py`

## Requirements & Installation

- Python 3.8+
- PyTorch + torchvision
- Pillow
- Optional: NVIDIA GPU and matching CUDA drivers

It's recommended to use a virtual environment (there is a `pytorch-env/` folder in this repo, or create your own):

```powershell
# create and activate a virtual environment (example)
python -m venv .venv
.\\.venv\\Scripts\\Activate.ps1
```

Install PyTorch according to your CUDA version. Example (PowerShell):

CPU-only:
```powershell
pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu
```

CUDA examples:
```powershell
# CUDA 12.9
pip3 install torch torchvision --index-url https://download.pytorch.org/whl/cu129
```

Then check PyTorch and CUDA availability:

```powershell
python -c "import torch; print('torch', torch.__version__); print('cuda available:', torch.cuda.is_available())"
```

Install other dependencies:

```powershell
pip install -r requirements.txt
```

## Files and usage notes

- `train.py`
  - Training script. Uses `dataset/train` and `dataset/val` subfolders as classes. Saves `best_classifier.pth` by default.

- `run.py`
  - Inference and batch-sorting tool. Reads images from `unsorted_images/` and copies them into `sorted_images/<class>/`.
  - Loads `best_classifier.pth` by default.
  - There's a `classes` list in the script that controls output folder names; keep training label order consistent with it.

- `dataset/train/<class_name>/` and `dataset/val/<class_name>/`
  - Put training/validation images in class-named subfolders (e.g., `anime`, `camera`, `other`).
  - Recommended formats: `.jpg`, `.jpeg`, `.png`.
  - Image sizes are handled by the training code (usually resized/cropped to 224x224).

- `unsorted_images/`
  - Place images you want to sort here. The script scans files in this folder (non-recursive by default).

- `sorted_images/`
  - Output folder created by `run.py`. Images are copied, original files are not deleted.

- `best_classifier.pth`
  - Model weights saved by `train.py`.

Notes:

- Class order matters: ensure the mapping from labels to indices during training matches the `classes` list used by `run.py`, otherwise results will be incorrect.
- File formats and permissions: ensure readable image files and avoid special characters that break paths.

## Class descriptions

Default classes in this project: `anime`, `camera`, `other`.

- `anime`: illustrations, anime-style or hand-drawn images (e.g., 2D characters, CG art, manga).
- `camera`: real photos taken by phones or cameras (portraits, scenes, everyday photos).
- `other`: screenshots, web captures, icons, tables, ads, mixed or hard-to-classify images.

If you change or add classes, update the `classes` list in `run.py` and keep label order consistent when training.

## Training

```powershell
python .\\train.py
```

Training saves `best_classifier.pth`.

## Inference / Batch sorting

```powershell
python .\\run.py
```

This will copy images from `unsorted_images/` to `sorted_images/` by predicted class.
